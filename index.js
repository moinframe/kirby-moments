(function(){"use strict";function s(e,t,o,c,p,d,k,f){var n=typeof e=="function"?e.options:e;return t&&(n.render=t,n.staticRenderFns=o,n._compiled=!0),{exports:e,options:n}}const i={data(){return{label:"",tokens:[]}},computed:{items(){return this.tokens.map(e=>({text:e.name,info:e.created,icon:{type:"key",back:"black"},options:[{text:this.t("delete"),icon:"trash",click:()=>this.openDeleteDialog(e.id)}]}))}},async created(){await this.loadTokens()},methods:{async loadTokens(){const e=await this.load();this.label=e.label,this.tokens=e.tokens||[]},t(e){return this.$t(e)},openCreateDialog(){this.$panel.dialog.open({component:"k-form-dialog",props:{fields:{name:{label:this.$t("moinframe.moments.panel.tokens.name"),type:"text",required:!0,placeholder:this.$t("moinframe.moments.panel.tokens.name.placeholder")}},submitButton:this.$t("moinframe.moments.panel.tokens.create")},on:{submit:async e=>{try{const t=await this.$api.post("moments/tokens",{name:e.name});this.$panel.dialog.close(),await this.loadTokens(),this.$panel.dialog.open({component:"k-form-dialog",props:{fields:{info:{type:"info",text:this.$t("moinframe.moments.panel.tokens.created.info")},token:{label:"Token",type:"text",disabled:!0,font:"monospace"}},value:{token:t.token},submitButton:!1,cancelButton:this.$t("close")}})}catch(t){this.$panel.notification.error(t.message||"Failed to create token")}}}})},openDeleteDialog(e){this.$panel.dialog.open({component:"k-remove-dialog",props:{text:this.$t("moinframe.moments.panel.tokens.delete.confirm")},on:{submit:async()=>{try{await this.$api.delete("moments/tokens/"+e),this.$panel.dialog.close(),this.$panel.notification.success(this.$t("moinframe.moments.panel.tokens.deleted")),await this.loadTokens()}catch(t){this.$panel.notification.error(t.message||"Failed to delete token")}}}})},onOption(e){e.click&&e.click()}}};var a=function(){var t=this,o=t._self._c;return o("k-section",{attrs:{label:t.label}},[o("k-button-group",{attrs:{slot:"options"},slot:"options"},[o("k-button",{attrs:{icon:"add",size:"xs",variant:"filled",theme:"positive",text:t.t("moinframe.moments.panel.tokens.add")},on:{click:t.openCreateDialog}})],1),t.tokens.length?o("k-items",{attrs:{items:t.items,layout:"list"},on:{option:t.onOption}}):o("k-empty",{attrs:{icon:"key"},on:{click:t.openCreateDialog}},[t._v(" "+t._s(t.t("moinframe.moments.panel.tokens.empty"))+" ")])],1)},l=[],m=s(i,a,l);const r=m.exports;panel.plugin("moinframe/moments",{icons:{moments:'<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 14C14.2091 14 16 12.2091 16 10C16 7.79086 14.2091 6 12 6C9.79086 6 8 7.79086 8 10C8 12.2091 9.79086 14 12 14ZM12 12C13.1046 12 14 11.1046 14 10C14 8.89543 13.1046 8 12 8C10.8954 8 10 8.89543 10 10C10 11.1046 10.8954 12 12 12Z" fill="black"/><path d="M7 5H5V7H7V5Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M2 2H22V22H2V2ZM4 4H20V15H4V4ZM4 17V20H20V17H4Z" fill="black"/></svg>'},sections:{"moments-tokens":r}})})();
